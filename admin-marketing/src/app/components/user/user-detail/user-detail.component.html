<!-- Start breadcrumb -->
<div class="row">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a routerLink="">Trang Chủ</a></li>
            <li class="breadcrumb-item"><a routerLink="/user-list">User</a></li>
            <li class="breadcrumb-item active" aria-current="page">Sửa thông tin User</li>
        </ol>
    </nav>
</div>
<!-- End breadcrumb -->
<div *ngIf="user">
	<form [formGroup]="formUser" novalidate (ngSubmit)="onSubmit()">
		<div *ngIf="errorMessage.non_field_errors" class="alert alert-danger fade in">
		   <span >{{ errorMessage.non_field_errors }}</span>
		</div>
		<div *ngIf="errors" class="alert alert-danger fade in">
			<span >{{ errors }}</span>.
		</div>
		<div class="row content-user">
			<p class="title-user-edit text-center">Sửa thông tin User</p>
			<div class="col-md-8">
				<div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block"> Email</label>
					</div>
					<div class="col-sm-8">	
						<input class='form-control' name="email"
						formControlName="email"
						(click)="removeErrorMessage()"
						>	
						<show-error-valid [control]="formUser.get('email')"></show-error-valid>
						<div *ngIf="errorMessage">
							<p class='errors'> {{ errorMessage.email }} </p>
						</div>
					</div>
				</div>
				<div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block">Loại User</label>
					</div>
					<div class="col-sm-8">
						<input type="hidden" name="role" formControlName="role">
						{{ user.role?.name }}
					</div>
				</div>
				<div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block">Trạng thái</label>
					</div>
					<div class="col-sm-8">	
						<input type="checkbox" name="is_active" value=""
				      		formControlName="is_active"
				      	>
				      	<label>Active</label>
				      	<p>Chỉ định xem người dùng này phải được coi là đang hoạt động.  Bạn nên bỏ chọn này thay vì xóa tài khoản</p>
					</div>
				</div>
				<div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block">Push thông báo</label>
					</div>
					<div class="col-sm-8">	
						<span><i class="fa fa-check-square" aria-hidden="true"></i></span>
					</div>
				</div>
				<div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block">Ngày tạo</label>
					</div>
					<div class="col-sm-3">	
						{{ user.modified | date:"dd/MM/yyyy" }}
					</div>
					<div class="col-sm-3">
						<label class="center-block">Ngày cập nhật</label>
					</div>
					<div class="col-sm-3">	
						{{ user.date_joined | date:"dd/MM/yyyy" }}
					</div>
				</div>
			</div>
		</div>
		<div class="row info-user-content ">
			<p class="info-users">Thông tin cá nhân</p>
			<div class="col-md-8">
				<div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block"> Họ và Tên</label>
					</div>
					<div class="col-sm-8">	
						<input class='form-control' name="full_name" 
						formControlName="full_name" type="text"
						>
						<show-error-valid [control]="formUser.get('full_name')"></show-error-valid>
						<div *ngIf="errorMessage">
							<p class='errors'> {{ errorMessage.full_name }} </p>
						</div>
	        		</div>
				</div>
				<div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block">Ngày sinh</label>
					</div>
		        	<div class="col-sm-8">	
						<div class="input-group">
			                <input type="text" class="form-control event-date" formControlName="birth_date" id="birth_date" name="birth_date" [owlDateTime]="dtBirtday"
			                />         
			                <owl-date-time [pickerType]="'calendar'"  #dtBirtday></owl-date-time>
			                <span class="input-group-addon" [owlDateTimeTrigger]="dtBirtday">
			                    <i class="fa fa-calendar"></i>
			                </span>
	        			</div>
	        			<show-error-valid [control]="formUser.get('birth_date')"></show-error-valid>
						<div *ngIf="errorMessage">
							<p class='errors'> {{ errorMessage.birth_date }} </p>
						</div>
		        	</div>
	        	</div>
	        	<div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block">Số điện thoại</label>
					</div>
		        	<div class="col-sm-8">	
						<input class='form-control' name="phone" 
						formControlName="phone" id="phone"
						>
						<show-error-valid [control]="formUser.get('phone')"></show-error-valid>
						<div *ngIf="errorMessage">
							<p class='errors'> {{ errorMessage.phone }} </p>
						</div>	
		        	</div>
	        	</div>
	        	<div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block">Chứng minh nhân dân</label>
					</div>
		        	<div class="col-sm-8">	
						<input class='form-control' name="personal_id" 
						formControlName="personal_id"
						>
						<show-error-valid [control]="formUser.get('personal_id')"></show-error-valid>
						<div *ngIf="errorMessage">
							<p class='errors'> {{ errorMessage.personal_id }} </p>
						</div>	
		        	</div>
	        	</div>
		        <div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block">Quốc gia </label>
					</div>
		        	<div class="col-sm-8">	
						<input class='form-control' name="country" 
						formControlName="country"
						>
						<show-error-valid [control]="formUser.get('country')"></show-error-valid>
						<div *ngIf="errorMessage">
							<p class='errors'> {{ errorMessage.country }} </p>
						</div>
		        	</div>
		        </div>
		        <div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block">Địa chỉ</label>
					</div>
		        	<div class="col-sm-8">	
						<input class='form-control' name="address" 
						formControlName="address"
						>
						<show-error-valid [control]="formUser.get('address')"></show-error-valid>
						<div *ngIf="errorMessage">
							<p class='errors'> {{ errorMessage.address }} </p>
						</div>	
		        	</div>
		        </div>
		        <div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block">Thành phố</label>
					</div>
		        	<div class="col-sm-8">	
						<input class='form-control' name="city" 
						formControlName="city"
						>
						<show-error-valid [control]="formUser.get('city')"></show-error-valid>
						<div *ngIf="errorMessage">
							<p class='errors'> {{ errorMessage.city }} </p>
						</div>	
		        	</div>
		        </div>
		        <div class="form-group row">
			        <div class="col-sm-3">
			            <label class="center-block">Hình Ảnh</label>
			        </div>
			        <div class="col-sm-8">
			        	<p *ngIf="user.avatar">
			                <span>Currently <a href="{{api_domain}}{{user.avatar}}" target="_blank">{{user.avatar}}</a></span>
			            </p>
		            	<input type="file" id="avatar" accept="image/*"
		            	(change)="onFileChange($event)"/>
		            	<show-error-valid [control]="formUser.get('avatar')"></show-error-valid>
		            	<div *ngIf="errorMessage">
							<p class='errors'> {{ errorMessage.avatar }} </p>
						</div>
		        	</div>
		    	</div>
		    	<div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block"> Mật khẩu mới</label>
					</div>
		        	<div class="col-sm-8">	
						<input class='input-password form-control' type="password" name="new_password" 
						formControlName="new_password" id="password"
						#input
						[readonly]="readonly_value"
						>
						<button (click)="showPassword(input)" type="button" class="file-icon btn btn-default"><span id="toggleShowHide" class="fa fa-eye-slash"></span></button>
						<show-error-valid [control]="formUser.get('new_password')"></show-error-valid>
						<div *ngIf="errorMessage">
							<p class='errors'> {{ errorMessage.password }} </p>
						</div>
						<input type="checkbox" (change)="ChangeReadonly($event)">  Thay đổi mật khẩu(Chức năng này chì dành cho System Admin)
		        	</div>
	        	</div>
	        	<input class='form-control' name="is_staff" 
					formControlName="is_staff" type="hidden">
			</div>
		</div>
		<div class='col-md-12'>
			<button (click)="confirmDeleteFeedback(user)" type="button" class="pull-left btn btn-danger">Xóa</button>
			<button type="submit" class="pull-right btn btn-info">Lưu lại</button>
		</div>
	</form>
</div>




