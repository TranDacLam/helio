<!-- Start breadcrumb -->
<div class="row">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a routerLink="">Trang Chủ</a></li>
            <li class="breadcrumb-item"><a routerLink="/user-list">User</a></li>
            <li class="breadcrumb-item active" aria-current="page">Sửa thông tin User</li>
        </ol>
    </nav>
</div>
<!-- End breadcrumb -->
<div *ngIf="user">
	<form [formGroup]="formUser" novalidate (ngSubmit)="onSubmit()">
		<div class="row content-user">
			<p class="title text-center">Sửa thông tin User</p>
			<hr>
			<div class="col-md-8">
				<div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block"> Email</label>
					</div>
					<div class="col-sm-8">	
						<input class='form-control' name="email"
						formControlName="email" type="email"
						[attr.disabled]="is_disable ? 'disabled' : null"
						(click)="removeErrorMessage()"
						>	
						<show-error-valid [control]="formUser.get('email')"></show-error-valid>
						<div *ngIf="errorMessage">
							<p class='errors'> {{ errorMessage.email }} </p>
						</div>
					</div>
				</div>
				<div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block">Loại User</label>
					</div>
					<div class="col-sm-8">
						<input type="hidden" name="role" formControlName="role">
						<div *ngIf="user.is_staff">
                            {{ user.role?.name }}
                        </div>
                        <div *ngIf="!user.is_staff">Customer</div>
					</div>
				</div>
				<div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block">Trạng thái</label>
					</div>
					<div class="col-sm-8">	
						<input type="checkbox" name="is_active" value=""
				      		formControlName="is_active"
				      		[attr.disabled]="is_disable ?'disabled' : null"
				      	>
				      	<label>Active</label>
				      	<p>Chỉ định xem người dùng này phải được coi là đang hoạt động.  Bạn nên bỏ chọn này thay vì xóa tài khoản</p>
					</div>
				</div>
				<div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block">Push thông báo</label>
					</div>
					<div class="col-sm-8">	
						<span><i class="fa fa-check-square" aria-hidden="true"></i></span>
					</div>
				</div>
				<div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block">Ngày tạo</label>
					</div>
					<div class="col-sm-3">	
						{{ user.date_joined | date:"dd/MM/yyyy HH:mm" }}
					</div>
					<div class="col-sm-3">
						<label class="center-block">Ngày cập nhật</label>
					</div>
					<div class="col-sm-3">	
						{{ user.modified | date:"dd/MM/yyyy HH:mm" }}
					</div>
				</div>
			</div>
		</div>
		<hr>
		<div class="row info-user-content ">
			<p class="info-users">Thông tin cá nhân</p>
			<hr>
			<div class="col-md-8">
				<div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block"> Họ và Tên</label>
					</div>
					<div class="col-sm-8">	
						<input class='form-control' name="full_name" 
						formControlName="full_name" type="text"
						[attr.disabled]="is_disable ?'disabled' : null"
						>
						<show-error-valid [control]="formUser.get('full_name')"></show-error-valid>
						<div *ngIf="errorMessage">
							<p class='errors'> {{ errorMessage.full_name }} </p>
						</div>
	        		</div>
				</div>
				<div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block">Ngày sinh</label>
					</div>
		        	<div class="col-sm-8">	
						<div class="input-group">
			                <input type="text" class="form-control event-date" formControlName="birth_date" id="birth_date" name="birth_date"
			                [owlDateTime]="dtBirtday"
			                />        
			                <owl-date-time [disabled]="is_disable" [pickerType]="'calendar'"  #dtBirtday></owl-date-time>
			                <span class="input-group-addon disabled-calender" [owlDateTimeTrigger]="dtBirtday">
			                    <i class="fa fa-calendar"></i>
			                </span>
	        			</div>
	        			<show-error-valid [control]="formUser.get('birth_date')"></show-error-valid>
						<div *ngIf="errorMessage">
							<p class='errors'> {{ errorMessage.birth_date }} </p>
						</div>
		        	</div>
	        	</div>
	        	<div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block">Số điện thoại</label>
					</div>
		        	<div class="col-sm-8">	
						<input class='form-control' name="phone" 
						formControlName="phone" id="phone" type="text"
						[attr.disabled]="is_disable ?'disabled' : null"
						(input)="validOnlyNumber(phone.value, 'phone')" #phone
						(click)="removeErrorMessage()"
						>
						<show-error-valid [control]="formUser.get('phone')"></show-error-valid>
						<div *ngIf="errorMessage">
							<p class='errors'> {{ errorMessage.phone }} </p>
						</div>	
		        	</div>
	        	</div>
	        	<div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block">Chứng minh nhân dân</label>
					</div>
		        	<div class="col-sm-8">	
						<input class='form-control' name="personal_id" 
						formControlName="personal_id" type="text"
						[attr.disabled]="is_disable ?'disabled' : null"
						(input)="validOnlyNumber(personal_id.value, 'personal_id')" #personal_id
						(click)="removeErrorMessage()"
						>
						<show-error-valid [control]="formUser.get('personal_id')"></show-error-valid>
						<div *ngIf="errorMessage">
							<p class='errors'> {{ errorMessage.personal_id }} </p>
						</div>	
		        	</div>
	        	</div>
		        <div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block">Quốc gia </label>
					</div>
		        	<div class="col-sm-8">	
						<input class='form-control' name="country" 
						formControlName="country" type="text"
						[attr.disabled]="is_disable ?'disabled' : null"
						>
						<show-error-valid [control]="formUser.get('country')"></show-error-valid>
						<div *ngIf="errorMessage">
							<p class='errors'> {{ errorMessage.country }} </p>
						</div>
		        	</div>
		        </div>
		        <div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block">Địa chỉ</label>
					</div>
		        	<div class="col-sm-8">	
						<input class='form-control' name="address" 
						formControlName="address" type="text"
						[attr.disabled]="is_disable ?'disabled' : null"
						>
						<show-error-valid [control]="formUser.get('address')"></show-error-valid>
						<div *ngIf="errorMessage">
							<p class='errors'> {{ errorMessage.address }} </p>
						</div>	
		        	</div>
		        </div>
		        <div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block">Thành phố</label>
					</div>
		        	<div class="col-sm-8">	
						<input class='form-control' name="city" 
						formControlName="city" type="text"
						[attr.disabled]="is_disable ?'disabled' : null"
						>
						<show-error-valid [control]="formUser.get('city')"></show-error-valid>
						<div *ngIf="errorMessage">
							<p class='errors'> {{ errorMessage.city }} </p>
						</div>	
		        	</div>
		        </div>
		        <div class="form-group row">
			        <div class="col-sm-3">
			            <label class="center-block">Hình Ảnh</label>
			        </div>
			        <div class="col-sm-8">
			        	<p *ngIf="user.avatar">
			                <span>Hiện tại: <a href="{{api_domain}}{{user.avatar}}" target="_blank">{{user.avatar}}</a></span>
			            </p>
			            <p *ngIf="user.avatar" class="clear_image">
                			<input type="checkbox" formControlName="is_clear_image"
                			[disabled]="is_disable"
                			/> Xóa
            			</p>
           				<p *ngIf="msg_clear_image" class="msg_error">{{msg_clear_image}}</p>
		            	<input type="file" id="avatar" accept="image/*"
		            	[attr.disabled]="is_disable ?'disabled' : null"
		            	(change)="onFileChange($event)"
		            	/>
		            	<show-error-valid [control]="formUser.get('avatar')"></show-error-valid>
		            	<div *ngIf="errorMessage">
							<p class='errors'> {{ errorMessage.avatar }} </p>
						</div>
		        	</div>
		    	</div>
		    	<div class="form-group row">
					<div class="col-sm-3">
						<label class="center-block"> Mật khẩu mới</label>
					</div>
		        	<div class="col-sm-8">	
						<input class='input-password form-control' type="password" name="new_password" 
						formControlName="new_password" id="password"
						#input
						[attr.disabled]="readonly_value ? 'disabled' : null"
						>
						<button (click)="showPassword(input)" [disabled]="user.is_staff == 0 || user_current?.role !== 1" type="button" class="file-icon btn btn-default"><span id="toggleShowHide" class="fa fa-eye-slash"></span></button>
						<show-error-valid [control]="formUser.get('new_password')"></show-error-valid>
						<div *ngIf="errorMessage">
							<p class='errors'> {{ errorMessage.password }} </p>
						</div>
						<input type="checkbox" [disabled]="user.is_staff == 0 || user_current?.role !== 1" (change)="ChangeReadonly($event)"> 
						Thay đổi mật khẩu(Chức năng này chỉ dành cho System Admin)
		        	</div>
	        	</div>
			</div>
		</div>
		<hr>
		<div class='col-md-12'>
			<button [disabled]="is_disable" (click)="confirmDeleteFeedback(user)" type="button" class="pull-left btn btn-danger">XÓA</button>
			<button [disabled]="is_disable" type="submit" class="pull-right btn btn-primary">LƯU LẠI</button>
		</div>
	</form>
</div>




